(()=>{"use strict";const e=window.wp.data,t=window.wp.url,c=window.wp.hooks,o=(e,t,{leading:c}={})=>{let o;return(...i)=>{!o&&c&&e(...i),clearTimeout(o),o=setTimeout((()=>e(...i)),t)}},i=o((e=>setKlaviyoCookie(e)),1e3),a=o(((e,t)=>makePublicAPIcall(e,t)),1e3),l=o((()=>s.trackStartedCheckout()),1e3),s=window.WCK||{};s.trackStartedCheckout=function(){var e={};if(kl_checkout.email)e.email=kl_checkout.email;else{if(!kl_checkout.exchange_id)return;e._kx=kl_checkout.exchange_id}makePublicAPIcall("client/events/",buildEventRequestPayload(e,kl_checkout.event_data,{name:"Started Checkout",service:"woocommerce"}))},window.addEventListener("load",(function(){const o={};(0,c.addAction)("experimental__woocommerce_blocks-checkout-set-email-address","klaviyo-checkout-block",(()=>{const{billingAddress:{email:c}}=(0,e.select)("wc/store/cart").getCustomerData();(0,t.isEmail)(c)&&(o.email=c,identify_object.properties=o,kl_checkout.email=c,l())})),(0,c.addAction)("experimental__woocommerce_blocks-checkout-set-billing-address","klaviyo-checkout-block",(()=>{const{billingAddress:{first_name:t,last_name:c}}=(0,e.select)("wc/store/cart").getCustomerData();t&&(o.first_name=t),c&&(o.last_name=c),identify_object.properties=o,i(o),a("client/profiles/",buildProfileRequestPayload(identify_object))}))}))})();